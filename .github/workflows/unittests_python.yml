# YAML schema for GitHub Actions:
# https://help.github.com/en/actions/automating-your-workflow-with-github-actions/workflow-syntax-for-github-actions
#
# Helpful YAML parser to clarify YAML syntax:
# https://yaml-online-parser.appspot.com/
#
# This workflow will run nightly or when triggered from PR comment

name: Python Unit Tests

on:
  merge_group:
  pull_request:
    branches: ["main"]
  push:
    branches: ["main"]
  workflow_dispatch:  # Allow manual triggers
  workflow_call:
    inputs:
      trigger-sha:
        required: true
        type: string


jobs:
  build:
    runs-on: ubuntu-latest
    name: "Run Unit Tests with Python ${{ matrix.python-version }} on ubuntu-latest"
    strategy:
      fail-fast: false
      matrix:
        python-version: ["3.10", "3.11", "3.12", "3.13"]

    steps:
    - uses: actions/checkout@v4

    - name: Install uv
      uses: astral-sh/setup-uv@v5
      with:
        enable-cache: true

    - name: Set up Python ${{ matrix.python-version }}
      run: uv python install ${{ matrix.python-version }}

    - name: Run tests
      run: uv run --python ${{ matrix.python-version }} pytest

